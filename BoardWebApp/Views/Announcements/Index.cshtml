@model List<BoardWebApp.Models.Announcement>

<h2>Оголошення</h2>

<form asp-action="Index" method="get" class="mb-3" id="filterForm">
    <select name="category" class="form-select" id="categorySelect">
        <option value="">-- Всі категорії --</option>
        @foreach (var cat in ViewBag.Categories as List<string>)
        {
            <option value="@cat" selected="@(cat == ViewBag.SelectedCategory)">
                @cat
            </option>
        }
    </select>

    <select name="subcategory" class="form-select mt-2" id="subcategorySelect">
        <option value="">-- Всі підкатегорії --</option>
        @foreach (var sub in ViewBag.Subcategories as List<string>)
        {
            <option value="@sub" selected="@(sub == ViewBag.SelectedSubcategory)">
                @sub
            </option>
        }
    </select>
</form>

@section Scripts {
    <script>
        document.getElementById('categorySelect').addEventListener('change', function () {
            // Reset subcategory select
            document.getElementById('subcategorySelect').selectedIndex = 0;
            // Submit the form
            document.getElementById('filterForm').submit();
        });

        document.getElementById('subcategorySelect').addEventListener('change', function () {
            document.getElementById('filterForm').submit();
        });
    </script>
}


<table class="table">
    <thead>
        <tr>
            <th>Назва</th>
            <th>Опис</th>
            <th>Категорія</th>
            <th>Підкатегорія</th>
            <th>Статус</th>
            <th>Дата створення</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var a in Model)
        {
            <tr>
                <td>@a.Title</td>
                <td>@a.Description</td>
                <td>@a.Category</td>
                <td>@a.SubCategory</td>
                <td>@(a.Status ? "Активне" : "Неактивне")</td>
                <td>@a.CreatedDate.ToShortDateString()</td>
                <td>
                    <a asp-action="Edit" asp-route-id="@a.Id">Редагувати</a> |
                    <a asp-action="Delete" asp-route-id="@a.Id">Видалити</a>
                </td>

            </tr>
        }
    </tbody>
</table>
